!function(e){"use strict";const o={modules:{}};e.Kakashi=o}(window),function(e,o){"use strict";const t=function(){let o=void 0;return{getOrCreateDB:()=>new Promise((t,n)=>{if(o)return void t(o);if(!e)return console.log("This browser doesn't support IndexedDB"),void n();const r=e.open("KakashiDB");r.onerror=function(e){console.log("idb.onerror"),console.dir(e),n()},r.onsuccess=(e=>{console.log("idb.onsuccess"),(o=e.target.result).onerror=function(e){console.log("Error",e.target.error.name)},t(o)}),r.onupgradeneeded=function(e){console.log("idb.onupgradeneeded");const o=e.target.result;!1===o.objectStoreNames.contains("stocks")&&(o.createObjectStore("stocks",{keyPath:"ticker"}),console.log("db.createObjectStore"))}}),toArray:function(e){return new Promise(function(o,t){const n=[];e.transaction(["stocks"],"readonly").objectStore("stocks").openCursor().onsuccess=function(e){var t=e.target.result;t?(console.log(`Cursor => key ${t.key} : value ${t.value}`),n.push(t.value),t.continue()):o(n)}})},addItemToDB:function(e,o){return new Promise(function(t,n){console.log("_addItemToDB => Enter");const r=e.transaction(["stocks"],"readwrite");r.oncomplete=function(e){console.log("_addItemToDB => transaction.oncomplete"),t()},r.onerror=function(e){console.log("_addItemToDB => Error",e.target.error.name),n()};const c=r.objectStore("stocks"),s=IDBKeyRange.only(o.ticker),a=c.openCursor(s);a.onsuccess=function(e){console.log("_addItemToDB => _cursor.onsuccess");let t=e.target.result?c.put(o):c.add(o);t.onsuccess=function(e){console.log("_addItemToDB => Woot! Did it")},t.onerror=function(e){console.log("_addItemToDB => Error",e.target.error.name),n()}},a.onerror=function(e){console.log("_addItemToDB => Error",e.target.error.name),n()}})},cleanTheHouse:function(e){return new Promise(function(o,t){console.log("_cleanTheHouse");const n=e.transaction(["stocks"],"readwrite");n.oncomplete=function(e){console.log("_cleanTheHouse => transaction.oncomplete"),o()},n.onerror=function(e){console.log("_cleanTheHouse => Error",e.target.error.name),t()};const r=n.objectStore("stocks"),c=r.openCursor();c.onsuccess=function(e){console.log("_cleanTheHouse => _cursor.onsuccess");var n=e.target.result;if(n){console.log("_cleanTheHouse => _cursor exists");let e=r.delete(n.key);e.onsuccess=function(e){console.log("_cleanTheHouse => Woot! Did it")},e.onerror=function(e){console.log("_cleanTheHouse => Error",e.target.error.name),t()},n.continue()}else console.log("_cleanTheHouse => _cursor undefined"),o()},c.onerror=function(e){console.log("_cleanTheHouse => Error",e.target.error.name),t()}})}}}();o.modules.IndexedDB=t}(window.indexedDB,window.Kakashi),function(e,o,t){"use strict";const n=function(){const t=[],n=function(){return o&&"granted"===o.permission};return{init:function(){!1===n()&&o&&o.requestPermission().then(o=>{"granted"===o&&e.addEventListener("unload",()=>{t.forEach(function(e){e.close()})})})},fire:function(r){n()?t.push(new o("Kakashi says:",{body:r})):e.alert(r)}}}();t.modules.Notification=n}(window,window.Notification,window.Kakashi),function(e){"use strict";const{IndexedDB:o,Notification:t}=e.modules;t.init();const n=function(){const e=`https://${["s","t","a","t","u","s","i","n","v","e","s","t",".","c","o","m",".","b","r","/","a","c","o","e","s","/"].join("")}`,n="kakashi.tickers",r=document.querySelector.bind(document),c=function(e){return`${e.ticker}\t${e.company.name}\t${e.company.doc}\t${e.company.sector}\t${e.company.subsector}\t${e.company.segment}`},s=function(){const e={ticker:"",company:{name:"",doc:"",sector:"",subsector:"",segment:""}};let o;if(e.ticker=r(".company-pages").children[0].firstElementChild.textContent,console.log(`=> build stock object for ${e.ticker}`),e.company.name=r(".company-description h4 span").textContent,e.company.doc=r(".company-description h4 small").textContent,document.querySelectorAll("span.sub-value").forEach(e=>{-1!=e.textContent.indexOf("Setor")&&(o=e.parentElement.parentElement.parentElement.parentElement)}),o){const t=o.querySelectorAll("strong");e.company.sector=t[0].textContent.toUpperCase(),e.company.subsector=t[1].textContent.toUpperCase(),e.company.segment=t[2].textContent.toUpperCase()}return e},a=function(o){const t=o.shift();console.log(`next ticker... ${t}`),window.localStorage.setItem(n,JSON.stringify(o)),console.log(`set ${n}, update!`),window.location.href=`${e}${t}`},i=function(){let e=window.localStorage.getItem(n);if(console.log(`get ${n}`),console.log(`1. kakashiTickers: ${e}`),!e){const o=r("#kakashiTickers").value;if(o&&(e=o.split(","),console.log(`2. kakashiTickers: ${e}. First time!`),e.length))return a(e)}e?("string"==typeof e&&(e=JSON.parse(e),console.log(`3. kakashiTickers: ${e}`)),function(e){return o.getOrCreateDB().then(t=>o.addItemToDB(t,e)).catch(e=>{console.log(`saveToDB => getOrCreateDB => catch: ${e}`),console.dir(arguments)})}(s()).then(()=>{console.log("stock saved in DB"),e.length?a(e):(window.localStorage.removeItem(n),console.log(`${n} removed!`),o.getOrCreateDB().then(e=>o.toArray(e)).then(e=>{e=e.map(c),navigator.clipboard.writeText(e.join("\n")).then(()=>{console.log("COPIED to navigator.clipboard"),t.fire(`Done! ${e.length} assets were copied to the navigator.clipboard`),o.getOrCreateDB().then(e=>o.cleanTheHouse(e)).then(()=>console.log("cleanTheHouse end!"))})}).catch(()=>{console.log("saveToDB => getOrCreateDB => catch"),console.dir(arguments)}))}).catch(()=>{console.log("saveToDB something wrong!")})):console.log("execWebScraping: nothing to do!")};return{match:function(o){return o.href.startsWith(e)},init:function(){const e=r(".company-pages"),o=e.querySelector('li[data-target="#company-section"]'),n=o.cloneNode(!0);n.removeAttribute("data-target"),n.querySelector("a").removeAttribute("title"),n.querySelector(".material-icons").textContent="content_copy",n.querySelector("span").textContent="COPY",e.appendChild(n),n.onclick=(()=>{const e=s();navigator.clipboard.writeText(c(e)).then(()=>{n.querySelector("span").textContent="COPIED!",setTimeout(()=>{n.querySelector("span").textContent="COPY"},2e3),t.fire("Copied!")})});const a=o.cloneNode(!0);a.removeAttribute("data-target"),a.querySelector("a").removeAttribute("title"),a.querySelector(".material-icons").textContent="content_copy",a.querySelector("span").textContent="COPY ALL",e.appendChild(a),a.onclick=(()=>{i()});const l=r(".tab-nav-resume"),u=document.querySelector(".container").cloneNode(),d=document.createElement("textarea");d.id="kakashiTickers",u.appendChild(d),l.parentNode.insertBefore(u,l.nextSibling),i()}}}();e.modules.StatusInvest=n}(window.Kakashi),function(e){"use strict";const{StatusInvest:o}=e.modules;o.match(window.location)&&o.init()}(window.Kakashi);